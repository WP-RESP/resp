var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},RESP_DATA=RESP_DATA||{},RespElement=function(_super){function RespElement(){var _this=_super.call(this)||this;return _this.autoRendering="true"===(_this.getAttribute("auto-rendering")||"true"),_this.postData=RespAPI.thePost,_this}return __extends(RespElement,_super),Object.defineProperty(RespElement.prototype,"trace",{get:function(){return"true"===(this.getAttribute("trace")||"false")},enumerable:!1,configurable:!0}),Object.defineProperty(RespElement.prototype,"encapsulate",{get:function(){return"true"===(this.getAttribute("encapsulate")||"false")},enumerable:!1,configurable:!0}),Object.defineProperty(RespElement.prototype,"keepContainer",{get:function(){return"true"===(this.getAttribute("keep-container")||"false")},enumerable:!1,configurable:!0}),Object.defineProperty(RespElement.prototype,"postData",{get:function(){return this._postData},set:function(data){this._postData=data,this.dispatchCustomEvent("onChange")},enumerable:!1,configurable:!0}),RespElement.prototype.dispatchCustomEvent=function(event,meta){void 0===meta&&(meta=null);var e=new CustomEvent(event,{detail:{data:meta}});this.dispatchEvent(e)},RespElement.prototype.connectedCallback=function(){this.dispatchCustomEvent("onConnected"),this.autoRendering&&(this.render(),this.dispatchCustomEvent("onRendered"))},RespElement}(HTMLElement),RespPosts=function(_super){function RespPosts(){var _this=_super.call(this)||this;return _this.template="",_this.embed=!1,_this}return __extends(RespPosts,_super),Object.defineProperty(RespPosts,"params",{get:function(){return[{id:null},{context:"context"},{password:"password"},{"per-page":"per_page"},{page:"page"},{offset:"offset"},{embed:"_embed"}]},enumerable:!1,configurable:!0}),RespPosts.prototype.getQueryString=function(){var _this=this,url=new URL(RESP_DATA.home+"/wp-json/wp/v2/posts");return RespPosts.params.forEach((function(e){var key=Object.keys(e)[0],value=_this.getAttribute(key)||"",currentUrl;"$"===value&&(value=new URL(location.href).searchParams.get(key)||"");""!==value&&(e[key]?url.searchParams.append(e[key],value):url.href=url.href+"/"+value),"embed"==key&&"true"==value&&(_this.embed=!0)})),decodeURI(url.toString())},RespPosts.prototype.getHeaders=function(){var cache=this.getAttribute("cache")||"false",headers=new Headers;return"no-cache"===cache&&headers.append("pragma","no-cache"),"false"!==cache&&headers.append("cache-control",cache),headers},RespPosts.prototype.render=function(){var _this=this;this.template=this.innerHTML,this.innerHTML="";var request=new Request(this.getQueryString()),headers=this.getHeaders();fetch(request,{headers:headers,credentials:"include"}).then((function(response){if(response.ok)return response.json();throw _this.trace?response:Error("Request rejected with status "+response.status)})).then((function(data){var shadow;Array.isArray(data)||(data=[data]),_this.encapsulate&&(shadow=_this.attachShadow({mode:"open"})),data.map((function(x){var author=null,thumbnail=null;return _this.embed&&(author=x._embedded.author,thumbnail=x._embedded["wp:featuredmedia"][0].media_details.sizes),{id:x.id,title:x.title.rendered,excerpt:x.excerpt.rendered,content:x.content.rendered,guid:x.guid.rendered,link:x.link,slug:x.slug,author:author?author.map((function(a){return{id:a.id,name:a.slug,url:a.link,avatar:a.avatar_urls}})):null,thumbnail:thumbnail}})).forEach((function(e){RespAPI.thePost=e,_this.encapsulate?shadow.innerHTML+=_this.template:_this.innerHTML+=_this.template})),_this.dispatchCustomEvent("onLoad",data)})).catch((function(err){_this.trace?(console.error(err),err.text().then((function(m){_this.dispatchCustomEvent("onError",JSON.parse(m))}))):_this.dispatchCustomEvent("onError",err)}))},RespPosts}(RespElement),RespMeta=function(_super){function RespMeta(){return _super.call(this)||this}return __extends(RespMeta,_super),RespMeta.prototype.render=function(){var _this=this;void 0!==this.postData&&this.postData.hasOwnProperty("id")&&this.postData&&RespAPI.getAttribute(this,"name",(function(v){_this.innerHTML=v,_this.keepContainer||(_this.outerHTML=_this.innerHTML)}))},RespMeta}(RespElement),RespTag=function(_super){function RespTag(){return _super.call(this)||this}return __extends(RespTag,_super),Object.defineProperty(RespTag.prototype,"reservedParams",{get:function(){return["name"]},enumerable:!1,configurable:!0}),RespTag.prototype.render=function(){var _this=this,name=this.getAttribute("name")||"div",dom=document.createElement(name),content=this.innerHTML;this.innerHTML="",this.getAttributeNames().filter((function(x){return-1===_this.reservedParams.indexOf(x)})).forEach((function(e){RespAPI.getAttribute(_this,e,(function(v){dom.setAttribute(e,v)}))})),dom.innerHTML=content,this.replaceWith(dom)},RespTag}(RespElement),RespAPI=function(){function RespAPI(){}return Object.defineProperty(RespAPI,"wpPostParams",{get:function(){return["id","excerpt","author","name","type","title","date","link","guid","thumbnail"]},enumerable:!1,configurable:!0}),RespAPI.getAttribute=function(element,attr,callback){var _this=this,value=element.getAttribute(attr)||"",params;value.split(/(?<=\$)(.*?)(?=\$)/g).forEach((function(p){var holder=__assign({},_this.thePost),path=p.split(":");-1!==RespAPI.wpPostParams.indexOf(path[0])&&(path.forEach((function(e){holder.hasOwnProperty(e)&&(holder=holder[e])})),value=value.replace("$"+p+"$",holder))})),callback(value)},RespAPI.init=function(){customElements.define("resp-meta",RespMeta),customElements.define("resp-tag",RespTag),customElements.define("resp-posts",RespPosts)},RespAPI.thePost={},RespAPI}();RespAPI.init();
//# sourceMappingURL=resp-api.min.js.map